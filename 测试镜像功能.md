# 测试镜像选择功能

## 快速测试步骤

1. **启动服务器**
   ```bash
   python3 -m http.server 8000
   ```

2. **打开应用**
   - 浏览器访问 `http://localhost:8000`
   - 按 F12 打开开发者工具（查看控制台日志）

3. **测试不同镜像**

   ### 测试 1: HF-Mirror (推荐)
   - 在"下载源"下拉菜单选择 "HF-Mirror (推荐国内用户)"
   - 点击"加载模型"
   - 控制台应显示：`使用 HF-Mirror 镜像加载模型`
   - 在 Network 标签页查看请求 URL 应包含 `hf-mirror.com`

   ### 测试 2: GitHub Proxy
   - 刷新页面（如果已加载模型，先删除）
   - 选择 "GitHub Proxy"
   - 点击"加载模型"
   - 控制台应显示：`使用 GitHub Proxy 镜像加载模型`
   - 请求 URL 应包含 `hub.gitmirror.com`

   ### 测试 3: 原始地址
   - 刷新页面
   - 选择 "原始地址 (海外用户)"
   - 点击"加载模型"
   - 控制台应显示：`使用原始 Hugging Face 地址加载模型`
   - 请求 URL 应包含 `huggingface.co`

## 预期结果

### 成功标志
- ✅ 控制台显示正确的镜像选择信息
- ✅ 进度条显示下载进度
- ✅ 模型状态从"未加载"变为"加载中..."再到"已加载"
- ✅ 弹出"模型加载成功！"提示
- ✅ "翻译"按钮变为可用状态

### 网络请求验证
打开 Network 标签页，筛选请求，应该看到：

**HF-Mirror 模式:**
```
https://hf-mirror.com/mlc-ai/Qwen3-0.6B-q0f16-MLC/...
https://ghp.ci/https://raw.githubusercontent.com/...
```

**GitHub Proxy 模式:**
```
https://hub.gitmirror.com/mlc-ai/Qwen3-0.6B-q0f16-MLC/...
https://raw.gitmirror.com/...
```

**原始地址模式:**
```
https://huggingface.co/mlc-ai/Qwen3-0.6B-q0f16-MLC/...
https://raw.githubusercontent.com/...
```

## 性能对比

可以在不同镜像站之间对比下载速度：

1. 删除模型（点击"删除模型"按钮）
2. 选择不同镜像源
3. 重新加载并记录下载时间
4. 选择速度最快的镜像站

## 故障排查

### 问题 1: 镜像选择不生效
- 检查控制台是否有 JavaScript 错误
- 确认下拉菜单的值是否正确选中
- 刷新页面重试

### 问题 2: 所有镜像都下载失败
- 检查网络连接
- 查看 Network 标签页的具体错误信息
- 可能是模型文件路径变化，需要更新代码

### 问题 3: 下载速度很慢
- 尝试其他镜像站
- 检查本地网络状况
- 考虑使用代理

## UI 截图位置

镜像选择下拉菜单应该出现在：
```
┌─────────────────────────────────┐
│  离线多语言翻译                  │
├─────────────────────────────────┤
│  模型状态: 未加载                │
│  [加载模型] [删除模型]           │
├─────────────────────────────────┤
│  下载源: [HF-Mirror (推荐)] ▼   │  ← 这是新增的选择器
├─────────────────────────────────┤
│  进度条: [||||||||    ] 80%     │
└─────────────────────────────────┘
```

## 添加新镜像站示例

如果发现更好的镜像站，可以这样添加：

1. 修改 `index.html` 第 414 行附近的 `mirrorConfigs`：
   ```javascript
   const mirrorConfigs = {
       // ... 现有配置
       'my-mirror': {
           name: '我的镜像',
           huggingface: 'https://my-hf-mirror.com',
           github: 'https://my-gh-mirror.com'
       }
   };
   ```

2. 修改第 310 行附近的 HTML 下拉菜单：
   ```html
   <option value="my-mirror">我的镜像</option>
   ```

3. 刷新页面，新镜像站就会出现在列表中
